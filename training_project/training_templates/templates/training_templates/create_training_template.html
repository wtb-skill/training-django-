<!-- templates/training_templates/create_training_template.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Create Training Template</title>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'training_templates/styles-2.css' %}">
</head>
<body>
    <h1>{% if template_id %}Edit{% else %}Create{% endif %} Training Template</h1>
    <form method="post" action="{% if template_id %}{% url 'edit_training_template' template_id=template_id %}{% else %}{% url 'create_training_template' %}{% endif %}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Save</button>
    </form>

    {% if template_id and selected_exercises %}
        <h2>Selected Exercises</h2>
        <ul>
            {% for exercise_order in selected_exercises %}
                <li>
                    <div class="exercise-container">
                        <span>{{ exercise_order.exercise.name }}</span>
                        <ul>
                        {% for set in exercise_order.sets.all %}
                            <li>{{ set.set_type }} - {{ set.reps }} x {{ set.weight }}</li>
                        {% endfor %}
                        </ul>
                        <form method="post" action="{% url 'move_up_exercise' template_id=template_id exercise_id=exercise_order.exercise.id %}" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="arrow-btn">‚¨ÜÔ∏è</button>
                        </form>
                        <form method="post" action="{% url 'move_down_exercise' template_id=template_id exercise_id=exercise_order.exercise.id %}" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="arrow-btn">‚¨áÔ∏è</button>
                        </form>
                        <form method="post" action="{% url 'delete_exercise' template_id=template_id exercise_id=exercise_order.exercise.id %}" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="trashcan-btn">üóëÔ∏è</button>
                        </form>
                    </div>
                    <h2>Add Set</h2>
                    <form method="post" action="{% url 'edit_training_template' template_id=template_id %}" style="display:inline;">
                        {% csrf_token %}
                        {{ set_form.as_p }}
                        <input type="hidden" name="exercise_order_id" value="{{ exercise_order.id }}">
                        <button type="submit" name="set_form">Add Set</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    {% endif %}

    {% if template_id and exercises %}
        <h2>Add Exercises</h2>
        <form method="post" action="{% url 'add_exercise' template_id=template_id %}">
            {% csrf_token %}
            <select name="exercise">
                {% for exercise in exercises %}
                    <option value="{{ exercise.id }}">{{ exercise.name }}</option>
                {% endfor %}
            </select>
            <button type="submit">Add Exercise</button>
        </form>
    {% endif %}

<!--    {% if request.session.template_id %}-->
    <form method="post" action="{% url 'finish_template' %}">
        {% csrf_token %}
        <button type="submit" class="finish-btn">Finish Template</button>
    </form>
<!--    {% endif %}-->
</body>
</html>
